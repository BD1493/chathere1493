<?php session_start(); $f='../data/file_users.json'; if(!file_exists($f)) file_put_contents($f,'{}'); $d=json_decode(file_get_contents($f),true); $u=$_POST['user']; $p=$_POST['pass']; if(!isset($d[$u])){$d[$u]=password_hash($p,PASSWORD_DEFAULT);} if(password_verify($p,$d[$u])){$_SESSION['file_user']=$u; file_put_contents($f,json_encode($d)); header('Location: ../files_dashboard.php');} else die('Invalid');